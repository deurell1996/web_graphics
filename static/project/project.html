<html>
    <head>
        <!-- Textures from: https://www.solarsystemscope.com/textures/ -->
        <title>Project: Solar System</title>
        <style>
            body { margin: 0; }
            canvas { width: 100%; height: 100% }
        </style>
    </head>
    <body>
        <div id="HUD">Controls
            <p>Change View:   Left Mouse + Drag </p>
            <p>Move Forward:  Front Arrow       </p>
            <p>Move Backward: Back  Arrow       </p>
            <p>Move Left:     Left  Arrow       </p>
            <p>Move Right:    Right Arrow       </p>
            <p>Move Up:       Shift             </p>
            <p>Move Down:     Ctrl              </p>
            <p>Reset Camera:  Space             </p>
        </div>
        <style>
            #HUD {
                position: absolute;
                top: 10px;
                left: 10px;
                text-align: left;
                line-height: 0.5;
                z-index: 100;
                display: block;
                color: #FFFF00;
            }
        </style>
        <script src="/static/vendor/three.js/build/three.min.js"></script>
        <script src="/static/vendor/three.js/examples/js/controls/OrbitControls.js"></script>
        <script>
            let scene, camera, renderer;
            let raycaster, mouse, INTERSECTED;

            function setup() {
                // Scene
                scene = new THREE.Scene();
                scene.background = new THREE.ImageUtils.loadTexture("/static/project/assets/2k_stars.jpg");

                // Renderer
                renderer = new THREE.WebGLRenderer();
                renderer.setSize( window.innerWidth, window.innerHeight );
                document.body.appendChild( renderer.domElement );

                // Camera
                camera = new THREE.PerspectiveCamera( 75, window.innerWidth/window.innerHeight, 0.1, 10000 );
                camera.position.set(1000, 400, 750);

                // Camera controls
				controls = new THREE.OrbitControls(camera, renderer.domElement);

                // Raycaster
                raycaster = new THREE.Raycaster();
                mouse = new THREE.Vector2(), INTERSECTED;

                // Sun
                sunGeometry = new THREE.SphereGeometry(128, 30, 30);
                sunTexture = new THREE.TextureLoader().load( '/static/project/assets/sun.jpg' );
                sunMaterial = new THREE.MeshLambertMaterial( { map: sunTexture } );
                sun = new THREE.Mesh( sunGeometry, sunMaterial );
                sun.name = "Sun";
                sun.translateX(0);
                scene.add( sun );

                // Mercury
                mercuryGeometry = new THREE.SphereGeometry(5, 30, 30);
                mercuryTexture = new THREE.TextureLoader().load( '/static/project/assets/mercury.jpg' );
                mercuryMaterial = new THREE.MeshLambertMaterial( { map: mercuryTexture } );
                mercury = new THREE.Mesh( mercuryGeometry, mercuryMaterial );
                mercury.name = "Mercury";
                scene.add( mercury );
                mercury_r = 128 + 50;
                mercury_theta = 0;
                mercury_dTheta = 2 * Math.PI / 250;

                // Venus
                venusGeometry = new THREE.SphereGeometry(10, 50, 50);
                venusTexture = new THREE.TextureLoader().load( '/static/project/assets/venus_surface.jpg' );
                venusMaterial = new THREE.MeshLambertMaterial( { map: venusTexture } );
                venus = new THREE.Mesh( venusGeometry, venusMaterial );
                venus.name = "Venus"
                scene.add( venus );
                venus_r = 128 + 90;
                venus_theta = 0;
                venus_dTheta = 2 * Math.PI / 300;
                // Venus's atmosphere
                atmosGeometry = new THREE.SphereGeometry(11, 50, 50);
                atmosTexture = new THREE.TextureLoader().load( '/static/project/assets/venus_atmosphere.jpg' );
                atmosMaterial = new THREE.MeshLambertMaterial( { map: atmosTexture, transparent: true, opacity: 0.9 } );
                atmosphere = new THREE.Mesh( atmosGeometry, atmosMaterial );
                atmosphere.name = "Venus (Atmosphere)"
                scene.add( atmosphere );
                atmosphere_r = 128 + 90;
                atmosphere_theta = 0;
                atmosphere_dTheta = 2 * Math.PI / 300;

                // Earth
                earthGeometry = new THREE.SphereGeometry(12, 75, 75);
                earthTexture = new THREE.TextureLoader().load( '/static/project/assets/earth.jpg' );
                earthMaterial = new THREE.MeshLambertMaterial( { map: earthTexture } );
                earth = new THREE.Mesh( earthGeometry, earthMaterial );
                earth.name = "Earth";
                scene.add( earth );
                earth_r = 128 + 130;
                earth_theta = 0;
                earth_dTheta = 2 * Math.PI / 325;
                // Earth's clouds
                cloudGeometry = new THREE.SphereGeometry(13, 75, 75);
                cloudTexture = new THREE.TextureLoader().load( '/static/project/assets/earth_clouds.jpg');
                cloudMaterial = new THREE.MeshLambertMaterial( { map: cloudTexture, transparent: true, opacity: 0.2 } );
                clouds = new THREE.Mesh( cloudGeometry, cloudMaterial );
                clouds.name = "Earth (Clouds)";
                scene.add( clouds );
                clouds_r = 128 + 130;
                clouds_theta = 0;
                clouds_dTheta = 2 * Math.PI / 325;

                // Mars
                marsGeometry = new THREE.SphereGeometry(10, 30, 30);
                marsTexture = new THREE.TextureLoader().load( '/static/project/assets/mars.jpg' );
                marsMaterial = new THREE.MeshLambertMaterial( { map: marsTexture } );
                mars = new THREE.Mesh( marsGeometry, marsMaterial );
                mars.name = "Mars";
                scene.add( mars );
                mars_r = 128 + 170;
                mars_theta = 0;
                mars_dTheta = 2 * Math.PI / 340;

                // Jupiter
                jupiterGeometry = new THREE.SphereGeometry(30, 30, 30);
                jupiterTexture = new THREE.TextureLoader().load( '/static/project/assets/jupiter.jpg' );
                jupiterMaterial = new THREE.MeshLambertMaterial( { map: jupiterTexture } );
                jupiter = new THREE.Mesh( jupiterGeometry, jupiterMaterial );
                jupiter.name = "Jupiter";
                scene.add( jupiter );
                jupiter_r = 128 + 500;
                jupiter_theta = 0;
                jupiter_dTheta = 2 * Math.PI / 680;

                // Saturn
                saturnGeometry = new THREE.SphereGeometry(20, 30, 30);
                saturnTexture = new THREE.TextureLoader().load( '/static/project/assets/saturn.jpg' );
                saturnMaterial = new THREE.MeshLambertMaterial( { map: saturnTexture } );
                saturn = new THREE.Mesh( saturnGeometry, saturnMaterial );
                saturn.name = "Saturn";
                scene.add( saturn );
                saturn_r = 128 + 625;
                saturn_theta = 0;
                saturn_dTheta = 2 * Math.PI / 750;
                // Saturn's ring
                ringGeometry = new THREE.RingGeometry(25, 40, 30);
                ringTexture = new THREE.TextureLoader().load( '/static/project/assets/saturn_ring.png' )
                ringMaterial = new THREE.MeshLambertMaterial( { map: ringTexture, transparent: true, opacity: 0.9, side: THREE.DoubleSide } );
                rings = new THREE.Mesh(ringGeometry, ringMaterial);
                rings.name = "Saturn's Rings";
                rings.rotateX(-(Math.PI / 4));
                rings.rotateY(Math.PI / 8);
                scene.add( rings );
                rings_r = 128 + 625;
                rings_theta = 0;
                rings_dTheta = 2 * Math.PI / 750;

                // Uranus
                uranusGeometry = new THREE.SphereGeometry(18, 30, 30);
                uranusTexture = new THREE.TextureLoader().load( '/static/project/assets/uranus.jpg' );
                uranusMaterial = new THREE.MeshLambertMaterial( { map: uranusTexture } );
                uranus = new THREE.Mesh( uranusGeometry, uranusMaterial );
                uranus.name = "Uranus";
                scene.add( uranus );
                uranus_r = 128 + 775;
                uranus_theta = 0;
                uranus_dTheta = 2 * Math.PI / 900;

                // Neptune
                neptuneGeometry = new THREE.SphereGeometry(16, 30, 30);
                neptuneTexture = new THREE.TextureLoader().load( '/static/project/assets/neptune.jpg' );
                neptuneMaterial = new THREE.MeshLambertMaterial( { map: neptuneTexture } );
                neptune = new THREE.Mesh( neptuneGeometry, neptuneMaterial );
                neptune.name = "Neptune";
                scene.add( neptune );
                neptune_r = 128 + 950;
                neptune_theta = 0;
                neptune_dTheta = 2 * Math.PI / 1000;

                // Asteroids
                asteroidGeometry1 = new THREE.SphereGeometry(1, 30, 30);
                asteroidGeometry2 = new THREE.SphereGeometry(2, 30, 30);
                asteroidGeometry3 = new THREE.SphereGeometry(3, 30, 30);
                asteroidGeometry4 = new THREE.SphereGeometry(4, 30, 30);
                asteroidGeometry5 = new THREE.SphereGeometry(5, 30, 30);
                asteroidTexture = new THREE.TextureLoader().load( '/static/project/assets/asteroid.jpg' );
                asteroidMaterial = new THREE.MeshLambertMaterial( { map: asteroidTexture } );
                asteroid = new THREE.Mesh( asteroidGeometry1, asteroidMaterial );
                asteroids = [];
                asteroidCount = 250
                for (var i = 0; i < asteroidCount; i++) {
                    newAsteroid = new THREE.Mesh( asteroidGeometry1, asteroidMaterial );
                    size = Math.floor(Math.random() * 5) + 1;
                    switch(size) {
                        case 1:
                            newAsteroid = new THREE.Mesh( asteroidGeometry1, asteroidMaterial );
                            break;
                        case 2:
                            newAsteroid = new THREE.Mesh( asteroidGeometry2, asteroidMaterial );
                            break;
                        case 3:
                            newAsteroid = new THREE.Mesh( asteroidGeometry3, asteroidMaterial );
                            break;
                        case 4:
                            newAsteroid = new THREE.Mesh( asteroidGeometry4, asteroidMaterial );
                            break;
                        case 5:
                            newAsteroid = new THREE.Mesh( asteroidGeometry5, asteroidMaterial );
                            break;
                    }
                    offset = Math.floor(Math.random() * 32) + 1;
                    upOrDown = Math.floor(Math.random() * 2) + 1;
                    if (upOrDown == 2) offset = -offset;

                    newAsteroid.translateY(offset);
                    asteroids.push(newAsteroid);
                    scene.add(newAsteroid);
                }

                asteroid_r = [];
                for (var i = 0; i < asteroidCount; i++)
                    asteroid_r.push(128 + 230 + Math.floor(Math.random() * 210) + 1); // 230-440

                asteroid_theta = [];
                for (var i = 0; i < asteroidCount; i++)
                    asteroid_theta.push(0);

                asteroid_dTheta = [];
                for (var i = 0; i < asteroidCount; i++)
                    asteroid_dTheta.push(2 * Math.PI / (Math.floor(Math.random() * 300) + 201));

                // Ambient light
                ambientlight = new THREE.AmbientLight(0xffffff, 1.0);
                scene.add(ambientlight);
            }

            function resize() {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize( window.innerWidth, window.innerHeight );
            }

            function animate() {
                requestAnimationFrame( animate );
                renderer.render( scene, camera );

                // Celestial rotations
                sun.rotation.y += 0.005;
                mercury.rotation.y += 0.005;
                venus.rotation.y += 0.005;
                atmosphere.rotation.y += 0.0025;
                earth.rotation.y += 0.005;
                clouds.rotation.y += 0.0025;
                mars.rotation.y += 0.005;
                jupiter.rotation.y += 0.005;
                saturn.rotation.y += 0.005;
                uranus.rotation.y += 0.005;
                neptune.rotation.y += 0.005;
                for (var i = 0; i < asteroidCount; i++)
                    asteroids[i].rotation.y += 0.0005;

                mercury_theta += mercury_dTheta;
                mercury.position.x = mercury_r * Math.cos(mercury_theta);
                mercury.position.z = mercury_r * Math.sin(mercury_theta);

                venus_theta += venus_dTheta;
                venus.position.x = venus_r * Math.cos(venus_theta);
                venus.position.z = venus_r * Math.sin(venus_theta);

                atmosphere_theta += atmosphere_dTheta;
                atmosphere.position.x = atmosphere_r * Math.cos(atmosphere_theta);
                atmosphere.position.z = atmosphere_r * Math.sin(atmosphere_theta);

                earth_theta += earth_dTheta;
                earth.position.x = earth_r * Math.cos(earth_theta);
                earth.position.z = earth_r * Math.sin(earth_theta);

                clouds_theta += clouds_dTheta;
                clouds.position.x = clouds_r * Math.cos(clouds_theta);
                clouds.position.z = clouds_r * Math.sin(clouds_theta);

                mars_theta += mars_dTheta;
                mars.position.x = mars_r * Math.cos(mars_theta);
                mars.position.z = mars_r * Math.sin(mars_theta);

                jupiter_theta += jupiter_dTheta;
                jupiter.position.x = jupiter_r * Math.cos(jupiter_theta);
                jupiter.position.z = jupiter_r * Math.sin(jupiter_theta);

                saturn_theta += saturn_dTheta;
                saturn.position.x = saturn_r * Math.cos(saturn_theta);
                saturn.position.z = saturn_r * Math.sin(saturn_theta);

                rings_theta += rings_dTheta;
                rings.position.x = rings_r * Math.cos(rings_theta);
                rings.position.z = rings_r * Math.sin(rings_theta);

                uranus_theta += uranus_dTheta;
                uranus.position.x = uranus_r * Math.cos(uranus_theta);
                uranus.position.z = uranus_r * Math.sin(uranus_theta);

                neptune_theta += neptune_dTheta;
                neptune.position.x = neptune_r * Math.cos(neptune_theta);
                neptune.position.z = neptune_r * Math.sin(neptune_theta);

                for (var i = 0; i < asteroids.length; i++) {
                    asteroid_theta[i] += asteroid_dTheta[i];
                    asteroids[i].position.x = asteroid_r[i] * Math.cos(asteroid_theta[i]);
                    asteroids[i].position.z = asteroid_r[i] * Math.sin(asteroid_theta[i]);
                }
            };

            document.addEventListener("keydown", onDocumentKeyDown, false);
            function onDocumentKeyDown(event) {
                var keyCode = event.which;
                if (keyCode == 16) {
                    camera.position.y += 10;
                } else if (keyCode == 17) {
                    camera.position.y -= 10;
                } else if (keyCode == 32) {
                    camera.position.set(1000, 400, 750);
                }
            }

            function onMouseMove( event ) {
                event.preventDefault();

                mouse.x = (event.clientX / window.innerWidth) * 2 + 1;
                mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
            }

            window.addEventListener("mousemove", onMouseMove, false)
            window.addEventListener("resize", resize, false);
            setup();
            animate();
        </script>
    </body>
</html>
